<project xmlns="http://maven.apache.org/POM/4.0.0"
		 xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
		 xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">
	<modelVersion>4.0.0</modelVersion>

	<parent>
		<artifactId>employeed-parent</artifactId>
		<groupId>org.chenile.samples.employeed</groupId>
		<version>${revision}</version>
		<relativePath>../pom.xml</relativePath>
	</parent>

	<artifactId>employeed-package</artifactId>
	<packaging>jar</packaging>

	<name>Employeed Package - Deploys the Employeed related set of service</name>
	<properties>
		<it.port>9092</it.port>
	</properties>

	<dependencies>

		<!-- Chenile Dependencies Starts -->
		<dependency>
			<groupId>org.chenile</groupId>
			<artifactId>chenile-http</artifactId>
		</dependency>
		<!-- Chenile Dependencies Ends -->

		<dependency>
			<groupId>ch.qos.logback</groupId>
			<artifactId>logback-classic</artifactId>
		</dependency>

		<dependency>
			<groupId>org.chenile</groupId>
			<artifactId>utils</artifactId>
		</dependency>
		<dependency>
			<groupId>org.chenile.samples.employeed</groupId>
			<artifactId>employeed-configurations</artifactId>
			<version>${revision}</version>
		</dependency>
		<dependency>
			<groupId>org.springdoc</groupId>
			<artifactId>springdoc-openapi-starter-webmvc-ui</artifactId>
		</dependency>
		<dependency>
			<groupId>com.h2database</groupId>
			<artifactId>h2</artifactId>
		</dependency>

		<!-- Start including all the services that need to be packaged with this mini monolith -->
		<dependency>
			<groupId>org.chenile.samples.employee</groupId>
			<artifactId>employee-service</artifactId>
			<version>0.0.1-SNAPSHOT</version>
		</dependency>
	</dependencies>
	<build>
		<resources>
			<resource>
				<directory>src/main/resources</directory>
				<filtering>true</filtering>
			</resource>
		</resources>
		<!--
		<plugins>
			<plugin>
				<groupId>org.codehaus.mojo</groupId>
				<artifactId>build-helper-maven-plugin</artifactId>
				<executions>
					<execution>
						<id>reserve-jmx-port</id>
						<goals>
							<goal>reserve-network-port</goal>
						</goals>
						<phase>process-resources</phase>
						<configuration>
							<portNames>
								<portName>boot.jmx.port</portName>
							</portNames>
						</configuration>
					</execution>
				</executions>
			</plugin>
			<plugin>
   				<groupId>org.springframework.boot</groupId>
				   <artifactId>spring-boot-maven-plugin</artifactId>
				   <configuration>
				      <jvmArguments>-Dspring.application.admin.enabled=true</jvmArguments>
					   <jmxPort>${boot.jmx.port}</jmxPort>
				   </configuration>
				   <executions>
				    <execution>
				     <id>pre-integration-test</id>
				     <goals>
				      <goal>start</goal>
				     </goals>
					<configuration>
						<profiles>
							<profile>it</profile>
						</profiles>
						<arguments>
							<argument>--server.port=${it.port}</argument>
						</arguments>
					</configuration>
				    </execution>
				    <execution>
				     <id>post-integration-test</id>
				     <goals>
				      <goal>stop</goal>
				     </goals>
				    </execution>
				   </executions>
  			</plugin>
  			<plugin>
			   <groupId>org.springdoc</groupId>
			   <artifactId>springdoc-openapi-maven-plugin</artifactId>
			   <version>1.1</version>
			   <executions>
			    <execution>
			     <id>integration-test</id>
			     <goals>
			      <goal>generate</goal>
			     </goals>
			    </execution>
			   </executions>
				<configuration>
					<apiDocsUrl>http://localhost:${it.port}/v3/api-docs</apiDocsUrl>
				</configuration>
  			</plugin>
  			<plugin>
			   <groupId>org.chenile</groupId>
			   <artifactId>chenile-config-maven-plugin</artifactId>
			   <executions>
			    <execution>
			     <id>integration-test</id>
			     <goals>
			      <goal>generate</goal>
			     </goals>
			    </execution>
			   </executions>
				<configuration>
					<serviceInfoUrlPrefix>http://localhost:${it.port}/service-info/</serviceInfoUrlPrefix>
					<infoUrl>http://localhost:${it.port}/info</infoUrl>
				</configuration>
  			</plugin>
		</plugins>
		-->
	</build>
	<profiles>
		<profile>
			<id>dev</id>
			<activation>
				<activeByDefault>true</activeByDefault>
			</activation>
			<properties>
				<!-- default Spring profiles -->
				<spring.profiles.active>dev</spring.profiles.active>
				<activatedProperties>dev</activatedProperties>
			</properties>
			<dependencies>
				<dependency>
					<groupId>org.springframework.boot</groupId>
					<artifactId>spring-boot-devtools</artifactId>
					<optional>true</optional>
				</dependency>
				<dependency>
					<groupId>com.h2database</groupId>
					<artifactId>h2</artifactId>
				</dependency>
			</dependencies>
			<build>
				<plugins>
					<plugin>
						<groupId>org.springframework.boot</groupId>
						<artifactId>spring-boot-maven-plugin</artifactId>
					</plugin>
				</plugins>
			</build>
		</profile>
		<profile>
			<id>store</id>
			<activation>
				<activeByDefault>true</activeByDefault>
			</activation>
			<properties>
				<!-- default Spring profiles -->
				<spring.profiles.active>store</spring.profiles.active>
				<activatedProperties>store</activatedProperties>
			</properties>
			<dependencies>
				<dependency>
					<groupId>org.springframework.boot</groupId>
					<artifactId>spring-boot-devtools</artifactId>
					<optional>true</optional>
				</dependency>
				<dependency>
					<groupId>com.h2database</groupId>
					<artifactId>h2</artifactId>
				</dependency>
			</dependencies>
			<build>
				<plugins>
					<plugin>
						<groupId>org.springframework.boot</groupId>
						<artifactId>spring-boot-maven-plugin</artifactId>
					</plugin>
				</plugins>
			</build>
		</profile>
		<profile>
			<id>sandbox</id>
			<activation>
				<activeByDefault>true</activeByDefault>
			</activation>
			<properties>
				<!-- default Spring profiles -->
				<spring.profiles.active>sandbox</spring.profiles.active>
				<activatedProperties>sandbox</activatedProperties>
			</properties>
			<dependencies>
				<dependency>
					<groupId>org.springframework.boot</groupId>
					<artifactId>spring-boot-devtools</artifactId>
					<optional>true</optional>
				</dependency>
				<dependency>
					<groupId>com.h2database</groupId>
					<artifactId>h2</artifactId>
				</dependency>
			</dependencies>
			<build>
				<plugins>
					<plugin>
						<groupId>org.springframework.boot</groupId>
						<artifactId>spring-boot-maven-plugin</artifactId>
					</plugin>
				</plugins>
			</build>
		</profile>
		<profile>
			<id>it</id>
			<activation>
				<activeByDefault>true</activeByDefault>
			</activation>
			<properties>
				<!-- default Spring profiles -->
				<spring.profiles.active>it</spring.profiles.active>
				<activatedProperties>it</activatedProperties>
			</properties>
			<dependencies>
				<dependency>
					<groupId>org.springframework.boot</groupId>
					<artifactId>spring-boot-devtools</artifactId>
					<optional>true</optional>
				</dependency>
				<dependency>
					<groupId>com.h2database</groupId>
					<artifactId>h2</artifactId>
				</dependency>
			</dependencies>
			<build>
				<plugins>
					<plugin>
						<groupId>org.springframework.boot</groupId>
						<artifactId>spring-boot-maven-plugin</artifactId>
					</plugin>
				</plugins>
			</build>
		</profile>
		<profile>
			<id>prod</id>
			<activation>
				<activeByDefault>true</activeByDefault>
			</activation>
			<properties>
				<!-- default Spring profiles -->
				<activatedProperties>prod</activatedProperties>
				<spring.profiles.active>prod</spring.profiles.active>
			</properties>
			<build>
				<plugins>
					<plugin>
						<groupId>org.apache.maven.plugins</groupId>
						<artifactId>maven-clean-plugin</artifactId>
						<configuration>
							<filesets>
								<fileset>
									<directory>target/classes/static/</directory>
								</fileset>
							</filesets>
						</configuration>
					</plugin>
					<plugin>
						<groupId>org.springframework.boot</groupId>
						<artifactId>spring-boot-maven-plugin</artifactId>
						<configuration>
							<profiles>
								<profile>dev</profile>
								<profile>prod</profile>
							</profiles>
						</configuration>
					</plugin>
				</plugins>
			</build>
			<dependencies>
				<dependency>
					<groupId>org.postgresql</groupId>
					<artifactId>postgresql</artifactId>
				</dependency>
			</dependencies>
		</profile>
	</profiles>
</project>
